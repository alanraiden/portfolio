- name: Install and build
  run: |
    cd portfolio
    npm ci
    npm run build

- name: Deploy to webroot (self-hosted runner)
  run: |
    sudo rm -rf /var/www/alansarang.dpdns.org/*
    sudo cp -r portfolio/dist/* /var/www/alansarang.dpdns.org/
    sudo chown -R www-data:www-data /var/www/alansarang.dpdns.org
    sudo find /var/www/alansarang.dpdns.org -type d -exec chmod 755 {} \;
    sudo find /var/www/alansarang.dpdns.org -type f -exec chmod 644 {} \;
    sudo systemctl reload apache2
  shell: bash
